################################################
#
#              Generated by Chef
#
################################################

[cache]
LOCAL_DATA_DIR = <%= node['bcpc']['graphite']['local_data_dir'] %> 
LOG_DIR =  <%= node['bcpc']['graphite']['local_log_dir'] %>
ENABLE_LOGROTATION = True
MAX_CACHE_SIZE = inf
MAX_UPDATES_PER_SECOND = <%= node['bcpc']['graphite']['carbon']['cache']['MAX_UPDATES_PER_SECOND'] %>
MAX_CREATES_PER_MINUTE = inf
LINE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:management][:ip]}"%>
LINE_RECEIVER_PORT = 2003
ENABLE_UDP_LISTENER = False
UDP_RECEIVER_INTERFACE = <%="#{node[:bcpc][:management][:ip]}"%>
UDP_RECEIVER_PORT = 2003
PICKLE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:management][:ip]}"%>
PICKLE_RECEIVER_PORT = 2004
USE_INSECURE_UNPICKLER = False
CACHE_QUERY_INTERFACE = <%="#{node[:bcpc][:management][:ip]}"%>
CACHE_QUERY_PORT = 7002
USE_FLOW_CONTROL = True
LOG_UPDATES = False
LOG_CACHE_HITS = False
LOG_CACHE_QUEUE_SORTS = False
CACHE_WRITE_STRATEGY = max 
WHISPER_AUTOFLUSH = False

[relay]
LINE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:graphite][:ip]}"%>
LINE_RECEIVER_PORT = 2013
PICKLE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:graphite][:ip]}"%>
PICKLE_RECEIVER_PORT = 2014
RELAY_METHOD = consistent-hashing
REPLICATION_FACTOR = <%="#{@min_quorum}"%>
DESTINATIONS = <%= "#{@servers.map{|x| x['mgmt_ip']+':2004'}.sort.join(', ')}" %>
MAX_QUEUE_SIZE = 10000
MAX_DATAPOINTS_PER_MESSAGE = 500
QUEUE_LOW_WATERMARK_PCT = 0.8
TIME_TO_DEFER_SENDING = 0.0001
USE_FLOW_CONTROL = True
USE_RATIO_RESET=False
MIN_RESET_STAT_FLOW=1000
MIN_RESET_RATIO=0.9
MIN_RESET_INTERVAL=121
METRIC_CLIENT_IDLE_TIMEOUT = <%="#{node[:bcpc][:graphite][:carbon][:relay][:idle_timeout]}"%> 

[aggregator]
LINE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:graphite][:ip]}"%>
LINE_RECEIVER_PORT = 2023
PICKLE_RECEIVER_INTERFACE = <%="#{node[:bcpc][:graphite][:ip]}"%>
PICKLE_RECEIVER_PORT = 2024
DESTINATIONS = <%= "#{@servers.map{|x| x['mgmt_ip']+':2004'}.join(', ')}" %>
REPLICATION_FACTOR = 1
MAX_QUEUE_SIZE = 10000
USE_FLOW_CONTROL = True
MAX_DATAPOINTS_PER_MESSAGE = 500
MAX_AGGREGATION_INTERVALS = 5
